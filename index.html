<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ISRRA-Q | Professional Assessment</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&family=Noto+Sans:wght@400;600;800&display=swap" rel="stylesheet">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    :root{
      --bg: #0f172a;
      --panel: #1e293b;
      --card: #1e293b;
      --text: #f1f5f9;
      --muted: #94a3b8;
      --accent: #38bdf8; /* Sky blue */
      --accent2: #818cf8; /* Indigo */
      --success: #34d399;
      --danger: #fb7185;
      --radius: 12px;
    }

    *{ box-sizing: border-box; }
    html,body{ height: 100%; }
    body{
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: Inter, system-ui, sans-serif;
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* --- HERO SCREEN --- */
    .hero-screen {
      position: fixed; inset: 0; z-index: 9999;
      background: radial-gradient(circle at 50% 30%, #1e293b 0%, #0f172a 80%);
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 20px; text-align: center; transition: opacity 0.6s ease;
    }
    .hero-content { max-width: 680px; animation: fadeInUp 0.8s ease-out; }
    
    .hero-title {
      font-size: 2.8rem; font-weight: 800; margin-bottom: 20px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .hero-text {
      font-size: 1.15rem; color: var(--muted); margin-bottom: 40px; font-weight: 300; line-height: 1.7;
    }
    .hero-btn {
      background: var(--accent); color: #0f172a; border: none;
      padding: 18px 45px; font-size: 1.1rem; font-weight: 700; border-radius: 50px;
      cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 0 25px rgba(56, 189, 248, 0.3);
    }
    .hero-btn:hover { transform: translateY(-2px); box-shadow: 0 0 35px rgba(56, 189, 248, 0.5); }
    
    .lang-toggle-hero {
      position: absolute; top: 30px; right: 30px;
      background: transparent; border: 1px solid rgba(255,255,255,0.2);
      color: var(--text); padding: 8px 16px; border-radius: 20px; cursor: pointer;
    }

    @keyframes fadeInUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }

    /* --- APP LAYOUT --- */
    .app-wrap {
      max-width: 850px; margin: 0 auto; padding: 40px 20px 100px;
      display: none; opacity: 0; transition: opacity 0.8s ease;
    }
    .app-wrap.active { display: block; opacity: 1; }

    header {
      background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.08); border-radius: var(--radius);
      padding: 24px; margin-bottom: 40px;
      position: sticky; top: 10px; z-index: 100; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    .header-flex { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .brand h1 { margin: 0; font-size: 1.4rem; font-weight: 700; color: var(--accent); }
    .brand small { color: var(--muted); font-size: 0.85rem; }

    .progress-track { height: 6px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; }
    .progress-fill { height: 100%; width: 0%; background: var(--accent); transition: width 0.3s ease; }
    .progress-text { text-align: right; font-size: 0.8rem; color: var(--muted); margin-top: 5px; }

    .btn-sm { background: rgba(255,255,255,0.1); border:none; color: white; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.85rem; margin-left: 8px;}

    /* --- QUESTIONS --- */
    .dim-block {
      background: var(--panel); border-radius: var(--radius); padding: 30px; margin-bottom: 30px;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .dim-header { border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; margin-bottom: 25px; }
    .dim-title { margin: 0; color: var(--accent); font-size: 1.3rem; }
    .dim-desc { margin: 5px 0 0; color: var(--muted); font-size: 0.95rem; }

    .item-row { margin-bottom: 35px; }
    .item-row:last-child { margin-bottom: 0; }
    .q-text { font-size: 1.05rem; margin-bottom: 12px; display: block; font-weight: 500; }
    .req-star { color: var(--accent2); font-size: 0.8rem; vertical-align: top; }

    .scale-wrap { display: flex; gap: 4px; }
    .scale-opt {
      flex: 1; position: relative; cursor: pointer; text-align: center;
    }
    .scale-opt input { position: absolute; opacity: 0; cursor: pointer; }
    .scale-box {
      display: block; padding: 12px 0; background: rgba(0,0,0,0.2); border-radius: 8px;
      color: var(--muted); font-weight: 600; transition: all 0.2s; border: 1px solid transparent;
    }
    .scale-opt:hover .scale-box { background: rgba(255,255,255,0.05); }
    .scale-opt input:checked + .scale-box {
      background: var(--accent); color: #0f172a; border-color: var(--accent); box-shadow: 0 0 15px rgba(56, 189, 248, 0.4);
    }
    
    .anchors { display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--muted); margin-top: 8px; }

    /* --- SUBMIT --- */
    .submit-area { text-align: center; margin-top: 50px; padding: 40px; background: var(--panel); border-radius: var(--radius); }
    .calc-btn {
      background: linear-gradient(135deg, var(--accent), var(--accent2)); color: white;
      border: none; padding: 16px 40px; font-size: 1.2rem; font-weight: 700; border-radius: 12px;
      cursor: pointer; transition: transform 0.2s; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    .calc-btn:hover { transform: scale(1.02); }
    .error-msg { color: var(--danger); margin-top: 15px; display: none; font-weight: 600; }

    /* --- RESULTS & REPORT (The visible part on screen) --- */
    .results-wrap { display: none; margin-top: 40px; animation: slideUp 0.8s ease; }
    .results-wrap.visible { display: block; }
    
    .email-box { margin-bottom: 20px; background: var(--panel); padding: 20px; border-radius: var(--radius); }
    .email-input {
      width: 100%; padding: 12px; background: #0f172a; border: 1px solid #334155;
      color: white; border-radius: 8px; margin-top: 8px;
    }

    /* --- PDF PRINT CONTAINER (Styled specifically for high contrast export) --- */
    #reportContainer {
      background: #ffffff; /* Must be white for PDF */
      color: #111827;      /* Must be dark for PDF */
      padding: 40px;
      border-radius: 4px;
      font-family: 'Noto Sans', sans-serif;
      display: none; /* Hidden until calculation */
    }
    
    /* When results are visible, show this container on screen but styled */
    .results-wrap.visible #reportContainer {
      display: block;
      margin-bottom: 30px;
      box-shadow: 0 0 50px rgba(0,0,0,0.5);
    }

    /* Internal styles for the report content */
    .rpt-header { border-bottom: 2px solid #0f172a; padding-bottom: 20px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: flex-end; }
    .rpt-logo { font-size: 1.8rem; font-weight: 800; color: #0f172a; letter-spacing: -1px; }
    .rpt-meta { text-align: right; font-size: 0.85rem; color: #64748b; }
    
    .rpt-profile-box { background: #f8fafc; border: 1px solid #e2e8f0; border-left: 5px solid #38bdf8; padding: 25px; margin-bottom: 30px; border-radius: 8px; }
    .rpt-code { font-family: monospace; font-size: 2.2rem; font-weight: 700; color: #0f172a; letter-spacing: 2px; }
    .rpt-name { font-size: 1.3rem; font-weight: 600; color: #334155; margin-bottom: 15px; }
    .rpt-desc { font-size: 0.95rem; line-height: 1.6; color: #334155; }
    .rpt-desc strong { color: #0f172a; }

    .rpt-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
    .rpt-table th { text-align: left; border-bottom: 2px solid #cbd5e1; padding: 10px; font-size: 0.85rem; text-transform: uppercase; color: #64748b; }
    .rpt-table td { border-bottom: 1px solid #e2e8f0; padding: 12px 10px; font-size: 0.95rem; color: #0f172a; }
    .badge { padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 700; display: inline-block; }
    .badge.H { background: #dcfce7; color: #15803d; }
    .badge.L { background: #fee2e2; color: #b91c1c; }

    .rpt-plan { background: #fff; border: 1px solid #e2e8f0; border-radius: 12px; padding: 25px; }
    .rpt-plan h3 { margin-top: 0; font-size: 1.1rem; color: #0f172a; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #e2e8f0; padding-bottom: 10px; }
    .plan-step { margin-bottom: 15px; }
    .plan-label { font-size: 0.75rem; text-transform: uppercase; color: #64748b; font-weight: 700; display: block; margin-bottom: 4px; }
    .plan-content { font-size: 1rem; color: #0f172a; font-weight: 500; }

    .actions { display: flex; gap: 15px; }
    .export-btn { flex: 1; padding: 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; font-size: 1rem; transition: 0.2s; }
    .pdf-btn { background: var(--accent); color: #0f172a; }
    .doc-btn { background: white; color: #0f172a; }
    .export-btn:hover { opacity: 0.9; transform: translateY(-1px); }

    @keyframes slideUp { from{transform:translateY(30px);opacity:0;} to{transform:translateY(0);opacity:1;} }
    @media print { body * { visibility: hidden; } #reportContainer, #reportContainer * { visibility: visible; } #reportContainer { position: absolute; left: 0; top: 0; width: 100%; } }
  </style>
</head>

<body>

  <div class="hero-screen" id="hero">
    <button class="lang-toggle-hero" id="heroLang">English</button>
    <div class="hero-content">
      <h1 class="hero-title" id="hTitle">Το Ρίσκο είναι Αφήγηση</h1>
      <p class="hero-text" id="hText">
        Κάθε μέρα παίρνεις αποφάσεις υπό πίεση. Κάποιες φορές το ένστικτο σε σώζει, άλλες σε παγιδεύει. 
        Το ISRRA δεν σε βαθμολογεί. Χαρτογραφεί τον "κώδικά" σου. 
        <br><br>
        Πώς αντιλαμβάνεσαι τον κίνδυνο όταν λείπουν τα δεδομένα; Πώς αντιδράς όταν η ομάδα σιωπά;
        Ανακάλυψε το προφίλ σου και λάβετε ένα επαγγελματικό πλάνο δράσης.
      </p>
      <button class="hero-btn" id="startBtn">START ASSESSMENT</button>
    </div>
  </div>

  <div class="app-wrap" id="app">
    
    <header>
      <div class="header-flex">
        <div class="brand">
          <h1>ISRRA-Q</h1>
          <small>Professional Risk Perception Inventory</small>
        </div>
        <div>
          <button class="btn-sm" id="appLang">EN/GR</button>
          <button class="btn-sm" id="resetBtn">Reset</button>
        </div>
      </div>
      <div class="progress-track">
        <div class="progress-fill" id="bar"></div>
      </div>
      <div class="progress-text" id="progTxt">0/50</div>
    </header>

    <div id="quizContainer">
      </div>

    <div class="submit-area">
      <button class="calc-btn" id="calcBtn">Υπολογισμός & Προβολή Αναφοράς</button>
      <div class="error-msg" id="errorMsg">Παρακαλώ απαντήστε σε όλες τις ερωτήσεις (50/50) για να προχωρήσετε.</div>
    </div>

    <div class="results-wrap" id="results">
      
      <div class="email-box">
        <label style="font-size:0.9rem; color:var(--muted);">Email Χρήστη (για την κεφαλίδα του PDF):</label>
        <input type="email" id="uEmail" class="email-input" placeholder="name@organization.com">
      </div>

      <div id="reportContainer">
        <div class="rpt-header">
          <div>
            <div class="rpt-logo">ISRRA-Q REPORT</div>
            <div style="font-size:0.9rem; margin-top:5px; color:#475569;">Professional Assessment</div>
          </div>
          <div class="rpt-meta">
            Date: <span id="rDate"></span><br>
            User: <span id="rEmail"></span>
          </div>
        </div>

        <div class="rpt-profile-box">
          <div class="rpt-code" id="rCode">-----</div>
          <div class="rpt-name" id="rName">Profile Name</div>
          <div class="rpt-desc" id="rDesc">
            </div>
        </div>

        <table class="rpt-table">
          <thead>
            <tr>
              <th>Dimension</th>
              <th>Score (1-7)</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="rTable"></tbody>
        </table>

        <div class="rpt-plan">
          <h3>Professional Micro-Plan (14 Days)</h3>
          <p style="font-size:0.9rem; color:#64748b; margin-bottom:20px; font-style:italic;">
            Σχεδιασμένο βάσει της αρχής ελαχίστης τριβής (Atomic Habits methodology).
          </p>
          <div id="rPlan"></div>
        </div>
      </div>
      <div class="actions">
        <button class="export-btn pdf-btn" id="pdfBtn">Download PDF</button>
        <button class="export-btn doc-btn" id="docBtn">Download Word</button>
      </div>

    </div>

  </div>

<script>
  /* --- DATA --- */
  const TEXT = {
    el: {
      hT: "Το Ρίσκο είναι Αφήγηση",
      hTx: "Κάθε μέρα παίρνεις αποφάσεις υπό πίεση. Κάποιες φορές το ένστικτο σε σώζει, άλλες σε παγιδεύει. Το ISRRA δεν σε βαθμολογεί. Χαρτογραφεί τον 'κώδικά' σου. \n\nΠώς αντιλαμβάνεσαι τον κίνδυνο όταν λείπουν τα δεδομένα; Πώς αντιδράς όταν η ομάδα σιωπά; Ανακάλυψε το προφίλ σου και λάβετε ένα επαγγελματικό πλάνο δράσης.",
      start: "ΕΝΑΡΞΗ", hLang: "English",
      calc: "Υπολογισμός & Προβολή Αναφοράς",
      err: "Παρακαλώ απαντήστε σε όλες τις ερωτήσεις (50/50).",
      pL: "Διαφωνώ", pR: "Συμφωνώ",
      dimF: "Πλαισίωση (Framing)", dimFd: "Πώς αντιλαμβάνεσαι την απειλή.",
      dimE: "Συναίσθημα (Emotion)", dimEd: "Η επίδραση του στρες στην κρίση.",
      dimC: "Επικοινωνία (Comm)", dimCd: "Σαφήνεια και ροή πληροφορίας.",
      dimA: "Δράση (Action)", dimAd: "Εκτέλεση υπό καθεστώς αβεβαιότητας.",
      dimS: "Κουλτούρα (Safety)", dimSd: "Συλλογική ευθύνη και εμπιστοσύνη.",
      planIntro: "Σχεδιασμένο με μεθοδολογία αλλαγής συμπεριφοράς.",
      s1: "TRIGGER (Το Σήμα)", s2: "MOTIVATION (Το Κίνητρο)", s3: "ACTION (Η Πράξη)", s4: "REWARD (Η Επιβεβαίωση)"
    },
    en: {
      hT: "Risk is a Narrative",
      hTx: "Every day you make decisions under pressure. Sometimes instinct saves you, sometimes it traps you. ISRRA does not grade you. It maps your 'code'. \n\nHow do you perceive danger when data is missing? How do you react when the team is silent? Discover your profile and get a professional action plan.",
      start: "START ASSESSMENT", hLang: "Ελληνικά",
      calc: "Calculate & View Report",
      err: "Please answer all questions (50/50).",
      pL: "Disagree", pR: "Agree",
      dimF: "Framing", dimFd: "How you perceive threat vs challenge.",
      dimE: "Emotion", dimEd: "Impact of stress on judgement.",
      dimC: "Communication", dimCd: "Clarity and information flow.",
      dimA: "Action", dimAd: "Execution under uncertainty.",
      dimS: "Safety Culture", dimSd: "Shared responsibility and trust.",
      planIntro: "Designed using behavioural change methodology.",
      s1: "CUE (The Trigger)", s2: "CRAVING (The Motivation)", s3: "RESPONSE (The Action)", s4: "REWARD (The Feedback)"
    }
  };

  const ITEMS = {
    F: [
       {en:"I tend to view risk as a challenge rather than a threat.", gr:"Τείνω να βλέπω το ρίσκο ως πρόκληση και όχι ως απειλή."},
       {en:"When faced with uncertainty, I try to make sense of the situation before acting.", gr:"Όταν υπάρχει αβεβαιότητα, προσπαθώ πρώτα να καταλάβω την κατάσταση και μετά να δράσω."},
       {en:"I usually relate risky situations to personal failure.", gr:"Συνήθως συνδέω τις ριψοκίνδυνες καταστάσεις με προσωπική αποτυχία."}, // R
       {en:"I can reframe negative events into opportunities for strategic learning.", gr:"Μπορώ να ξαναπλαισιώσω αρνητικά γεγονότα ως ευκαιρίες για στρατηγική μάθηση."},
       {en:"I often get stuck in a single narrative when thinking about risk.", gr:"Συχνά κολλάω σε μία μόνο αφήγηση όταν σκέφτομαι το ρίσκο."}, // R
       {en:"The way I talk about risk influences how others perceive it.", gr:"Ο τρόπος που μιλάω για το ρίσκο επηρεάζει το πώς το αντιλαμβάνονται οι άλλοι."},
       {en:"I consciously shape the story I tell myself about danger or uncertainty.", gr:"Συνειδητά διαμορφώνω την ιστορία που λέω στον εαυτό μου για κίνδυνο ή αβεβαιότητα."},
       {en:"I believe that the framing of a problem determines its possible solutions.", gr:"Πιστεύω ότι η πλαισίωση ενός προβλήματος καθορίζει τις πιθανές λύσεις."},
       {en:"I use language that normalises uncertainty when I explain risks to others.", gr:"Χρησιμοποιώ γλώσσα που κανονικοποιεί την αβεβαιότητα όταν εξηγώ ρίσκα σε άλλους."},
       {en:"I experience risk as an open ended experience, not something strictly positive or negative.", gr:"Βιώνω το ρίσκο ως μια ανοιχτή εμπειρία και όχι ως κάτι αυστηρά θετικό ή αρνητικό."},
    ],
    E: [
       {en:"My emotions interfere with how accurately I assess risk.", gr:"Τα συναισθήματά μου παρεμβαίνουν στο πόσο ακριβώς εκτιμώ το ρίσκο."}, // R
       {en:"I remain calm and analytical when faced with high pressure situations.", gr:"Παραμένω ήρεμος και αναλυτικός όταν αντιμετωπίζω καταστάσεις υψηλής πίεσης."},
       {en:"I tend to exaggerate potential negative outcomes when under stress.", gr:"Τείνω να υπερβάλλω τις πιθανές αρνητικές εκβάσεις όταν είμαι υπό στρες."}, // R
       {en:"I can recognise when fear is distorting my perception of risk.", gr:"Μπορώ να αναγνωρίσω όταν ο φόβος αλλοιώνει την αντίληψή μου για το ρίσκο."},
       {en:"I often assume the worst even when evidence is lacking.", gr:"Συχνά υποθέτω το χειρότερο, ακόμη και όταν λείπουν στοιχεία."}, // R
       {en:"I notice how my mood shifts the way I interpret threats.", gr:"Παρατηρώ πώς η διάθεσή μου αλλάζει τον τρόπο που ερμηνεύω απειλές."},
       {en:"I regulate my emotional response before making risk related decisions.", gr:"Ρυθμίζω τη συναισθηματική μου αντίδραση πριν πάρω αποφάσεις σχετικές με ρίσκο."},
       {en:"I struggle to separate personal feelings from objective assessment.", gr:"Δυσκολεύομαι να ξεχωρίσω προσωπικά συναισθήματα από αντικειμενική εκτίμηση."}, // R
       {en:"I feel confident in my ability to assess risk clearly under pressure.", gr:"Νιώθω σίγουρος ότι μπορώ να εκτιμώ καθαρά το ρίσκο υπό πίεση."},
       {en:"I use mental strategies to avoid overreacting in uncertain situations.", gr:"Χρησιμοποιώ νοητικές στρατηγικές για να αποφεύγω την υπεραντίδραση σε καταστάσεις αβεβαιότητας."},
    ],
    C: [
       {en:"I know how to communicate risk without causing panic.", gr:"Ξέρω πώς να επικοινωνώ το ρίσκο χωρίς να προκαλώ πανικό."},
       {en:"I adapt my message depending on who I’m speaking to in risky situations.", gr:"Προσαρμόζω το μήνυμά μου ανάλογα με το σε ποιον μιλάω σε ριψοκίνδυνες καταστάσεις."},
       {en:"I prefer to avoid discussing risks if they are emotionally charged.", gr:"Προτιμώ να αποφεύγω τη συζήτηση για ρίσκα όταν έχουν έντονο συναισθηματικό φορτίο."}, // R
       {en:"I can clearly explain what makes a situation risky.", gr:"Μπορώ να εξηγήσω καθαρά τι κάνει μια κατάσταση ριψοκίνδυνη."},
       {en:"I often hesitate to express concern about potential dangers.", gr:"Συχνά διστάζω να εκφράσω ανησυχία για πιθανούς κινδύνους."}, // R
       {en:"I structure risk related information to help others act appropriately.", gr:"Δομώ τις πληροφορίες για το ρίσκο ώστε να βοηθώ τους άλλους να δράσουν κατάλληλα."},
       {en:"I use storytelling when communicating risk to others.", gr:"Χρησιμοποιώ αφήγηση όταν επικοινωνώ ρίσκο σε άλλους."},
       {en:"I am confident in my ability to express complex threats in simple terms.", gr:"Νιώθω σίγουρος ότι μπορώ να εξηγώ σύνθετες απειλές με απλούς όρους."},
       {en:"I avoid downplaying or exaggerating risk when talking to others.", gr:"Αποφεύγω να υποβαθμίζω ή να υπερβάλλω το ρίσκο όταν μιλάω σε άλλους."},
       {en:"I communicate risks in a way that encourages responsible action.", gr:"Επικοινωνώ τα ρίσκα με τρόπο που ενθαρρύνει υπεύθυνη δράση."},
    ],
    A: [
       {en:"When I sense risk, I take action quickly and deliberately.", gr:"Όταν αντιλαμβάνομαι ρίσκο, δρω γρήγορα και σκόπιμα."},
       {en:"I often know what to do, but delay action due to uncertainty.", gr:"Συχνά ξέρω τι πρέπει να κάνω, αλλά καθυστερώ λόγω αβεβαιότητας."}, // R
       {en:"I act in alignment with what I understand about the situation's risk.", gr:"Δρω σε ευθυγράμμιση με αυτά που καταλαβαίνω για το ρίσκο της κατάστασης."},
       {en:"I adapt my behaviour based on my assessment of threats.", gr:"Προσαρμόζω τη συμπεριφορά μου με βάση την εκτίμησή μου για τις απειλές."},
       {en:"I feel paralysed when I encounter situations involving uncertainty.", gr:"Νιώθω παράλυση όταν αντιμετωπίζω καταστάσεις με αβεβαιότητα."}, // R
       {en:"I follow through with planned actions even under pressure.", gr:"Ολοκληρώνω τις προγραμματισμένες ενέργειες ακόμη και υπό πίεση."},
       {en:"I take steps to mitigate risk rather than ignore it.", gr:"Κάνω βήματα για να μετριάσω το ρίσκο, αντί να το αγνοώ."},
       {en:"I find it easy to operationalise my thoughts into concrete behaviours.", gr:"Μου είναι εύκολο να μετατρέπω τις σκέψεις μου σε συγκεκριμένες συμπεριφορές."},
       {en:"I respond to emerging threats in a methodical and structured way.", gr:"Απαντώ σε αναδυόμενες απειλές με μεθοδικό και δομημένο τρόπο."},
       {en:"I often fail to implement what I know should be done in risky situations.", gr:"Συχνά αποτυγχάνω να εφαρμόσω αυτό που ξέρω ότι πρέπει να γίνει σε ριψοκίνδυνες καταστάσεις."}, // R
    ],
    S: [
       {en:"I feel responsible for contributing to the safety of my team.", gr:"Νιώθω υπεύθυνος να συμβάλλω στην ασφάλεια της ομάδας μου."},
       {en:"I often stay silent about safety concerns to avoid conflict.", gr:"Συχνά μένω σιωπηλός για θέματα ασφάλειας, για να αποφύγω σύγκρουση."}, // R
       {en:"I believe my input on safety matters is valued in my environment.", gr:"Πιστεύω ότι η γνώμη μου για θέματα ασφάλειας εκτιμάται στο περιβάλλον μου."},
       {en:"I act in ways that support a shared culture of responsibility.", gr:"Λειτουργώ με τρόπους που στηρίζουν μια κοινή κουλτούρα ευθύνης."},
       {en:"I feel disconnected from how safety is managed around me.", gr:"Νιώθω αποσυνδεδεμένος από το πώς διαχειρίζεται η ασφάλεια γύρω μου."}, // R
       {en:"I encourage others to speak up when they notice risk.", gr:"Ενθαρρύνω τους άλλους να μιλήσουν όταν παρατηρούν ρίσκο."},
       {en:"I see myself as part of the broader safety system, not just an individual.", gr:"Βλέπω τον εαυτό μου ως μέρος του ευρύτερου συστήματος ασφάλειας και όχι μόνο ως άτομο."},
       {en:"I take initiative to improve how my group handles risky situations.", gr:"Παίρνω πρωτοβουλία για να βελτιώσω το πώς η ομάδα μου χειρίζεται ριψοκίνδυνες καταστάσεις."},
       {en:"I trust that if I report a problem, it will be taken seriously.", gr:"Εμπιστεύομαι ότι αν αναφέρω ένα πρόβλημα, θα ληφθεί σοβαρά υπόψη."},
       {en:"I feel that my values align with the safety culture of my workplace team.", gr:"Νιώθω ότι οι αξίες μου ευθυγραμμίζονται με την κουλτούρα ασφάλειας του χώρου ή της ομάδας μου."},
    ]
  };

  const REVERSE = { F:[3,5], E:[1,3,5,8], C:[3,5], A:[2,5,10], S:[2,5] };

  // --- RICH INTERPRETATION DATA (Developed) ---
  const INTERP = {
    F: {
      H: { el:"Αντιμετωπίζετε το ρίσκο ως στρατηγικό γρίφο. Έχετε την ικανότητα να βλέπετε ευκαιρίες εκεί που άλλοι βλέπουν μόνο εμπόδια. Η 'πλαισίωσή' σας είναι προσανατολισμένη στη λύση, γεγονός που σας κάνει ανθεκτικούς στην αλλαγή.", 
           en:"You perceive risk as a strategic puzzle. You have the ability to see opportunities where others see only obstacles. Your framing is solution-oriented, making you resilient to change." },
      L: { el:"Τείνετε να ερμηνεύετε το άγνωστο ως προσωπική απειλή. Αυτό το αμυντικό πλαίσιο μπορεί να οδηγήσει σε αποφυγή απαραίτητων ρίσκων και σε υπερβολική προσκόλληση στο 'status quo' για ασφάλεια.", 
           en:"You tend to interpret the unknown as a personal threat. This defensive framing can lead to avoiding necessary risks and sticking excessively to the 'status quo' for safety." }
    },
    E: {
      H: { el:"Διαθέτετε υψηλή συναισθηματική σταθερότητα. Μπορείτε να διαχωρίσετε το 'σήμα' (δεδομένα) από τον 'θόρυβο' (φόβος) σε κρίσιμες στιγμές, διατηρώντας την κρίση σας καθαρή.", 
           en:"You possess high emotional stability. You can separate the 'signal' (data) from the 'noise' (fear) during critical moments, keeping your judgement clear." },
      L: { el:"Το στρες επηρεάζει άμεσα την κρίση σας. Σε συνθήκες πίεσης, το συναισθηματικό φίλτρο θολώνει, οδηγώντας είτε σε παρορμητικές αποφάσεις είτε σε 'πάγωμα'.", 
           en:"Stress directly affects your judgement. Under pressure, your emotional filter blurs, leading to either impulsive decisions or freezing." }
    },
    C: {
      H: { el:"Είστε σαφής πομπός μηνυμάτων. Δεν διστάζετε να επικοινωνήσετε δυσάρεστα νέα αν αυτό προστατεύει την ομάδα. Η διαφάνεια είναι το όπλο σας.", 
           en:"You are a clear transmitter of messages. You do not hesitate to communicate unpleasant news if it protects the team. Transparency is your weapon." },
      L: { el:"Υπάρχει δισταγμός στην έκφραση ανησυχιών. Πιθανώς αποφεύγετε τη σύγκρουση ή φοβάστε πως θα χαρακτηριστείτε ως 'αρνητικός', με αποτέλεσμα κρίσιμες πληροφορίες να χάνονται.", 
           en:"There is hesitation in expressing concerns. You likely avoid conflict or fear being labeled 'negative', causing critical information to be lost." }
    },
    A: {
      H: { el:"Μετατρέπετε τη σκέψη σε πράξη με ταχύτητα. Δεν περιμένετε το τέλειο σενάριο για να κινηθείτε. Αντιλαμβάνεστε ότι η αδράνεια είναι συχνά μεγαλύτερο ρίσκο από τη δράση.", 
           en:"You convert thought into action swiftly. You do not wait for the perfect scenario to move. You realize that inaction is often a greater risk than action." },
      L: { el:"Υποφέρετε από 'παράλυση ανάλυσης'. Η ανάγκη για βεβαιότητα σάς κρατά πίσω, με αποτέλεσμα να χάνεται πολύτιμος χρόνος αντίδρασης σε αναδυόμενες απειλές.", 
           en:"You suffer from 'analysis paralysis'. The need for certainty holds you back, resulting in lost reaction time to emerging threats." }
    },
    S: {
      H: { el:"Λειτουργείτε με γνώμονα το σύνολο. Αντιλαμβάνεστε την ασφάλεια ως συλλογικό αγαθό και ενθαρρύνετε ενεργά τους άλλους να μιλήσουν (psychological safety).", 
           en:"You operate with the whole in mind. You perceive safety as a collective asset and actively encourage others to speak up (psychological safety)." },
      L: { el:"Λειτουργείτε πιο ατομικά. Πιθανώς νιώθετε ότι η ασφάλεια είναι ευθύνη 'άλλων' ή των διαδικασιών, χάνοντας την αίσθηση της προσωπικής επιρροής στο σύστημα.", 
           en:"You operate more individually. You likely feel safety is the responsibility of 'others' or procedures, losing the sense of personal influence on the system." }
    }
  };

  /* --- ATOMIC PLAN LOGIC --- */
  function getPlan(minDim, lang){
    const isEl = lang==='el';
    const plans = {
      F: { // Framing Plan
        trigger: isEl ? "Όταν ανοίγετε τα email το πρωί και νιώθετε πίεση..." : "When you open emails in the morning and feel pressure...",
        motive: isEl ? "Σκεφτείτε: 'Αυτό είναι ένα παζλ που πρέπει να λύσω, όχι απειλή'." : "Think: 'This is a puzzle to solve, not a threat'.",
        action: isEl ? "Γράψτε σε χαρτί ΜΙΑ ευκαιρία που κρύβεται σε αυτό το πρόβλημα (Κανόνας 2 λεπτών)." : "Write down ONE opportunity hidden in this problem (2-minute rule).",
        reward: isEl ? "Βάλτε ένα 'tick' στο ημερολόγιο. Η αίσθηση ελέγχου είναι η ανταμοιβή." : "Tick the box on your calendar. The sense of control is the reward."
      },
      E: { // Emotion Plan
        trigger: isEl ? "Όταν αισθανθείτε ταχυπαλμία ή ένταση σε meeting..." : "When you feel rapid heartbeat or tension in a meeting...",
        motive: isEl ? "Υπενθύμιση: 'Η ηρεμία είναι η υπερδύναμή μου τώρα'." : "Reminder: 'Calmness is my superpower right now'.",
        action: isEl ? "Πάρτε 3 βαθιές ανάσες πριν μιλήσετε. Μην απαντήσετε αμέσως." : "Take 3 deep breaths before speaking. Do not reply immediately.",
        reward: isEl ? "Παρατηρήστε πόσο πιο καθαρή ήταν η απάντησή σας." : "Notice how much clearer your answer was."
      },
      C: { // Communication Plan
        trigger: isEl ? "Όταν παρατηρείτε κάτι στραβό αλλά διστάζετε να το πείτε..." : "When you notice something wrong but hesitate to speak...",
        motive: isEl ? "Σκεφτείτε: 'Η σιωπή μου μπορεί να κοστίσει στην ομάδα'." : "Think: 'My silence could cost the team'.",
        action: isEl ? "Στείλτε το μήνυμα ξεκινώντας με τη φράση: 'Για την ασφάλειά μας, παρατήρησα...'" : "Send the message starting with: 'For our safety, I noticed...'",
        reward: isEl ? "Δεχτείτε την ανακούφιση ότι κάνατε το καθήκον σας." : "Accept the relief that you did your duty."
      },
      A: { // Action Plan
        trigger: isEl ? "Όταν αναβάλετε μια απόφαση περιμένοντας περισσότερα δεδομένα..." : "When you delay a decision waiting for more data...",
        motive: isEl ? "Υπενθύμιση: 'Η ατελής δράση είναι καλύτερη από την τέλεια αδράνεια'." : "Reminder: 'Imperfect action is better than perfect inaction'.",
        action: isEl ? "Κάντε το μικρότερο δυνατό πρώτο βήμα (π.χ. ένα τηλεφώνημα) ΤΩΡΑ." : "Take the smallest possible first step (e.g., a phone call) NOW.",
        reward: isEl ? "Γιορτάστε το γεγονός ότι ξεκολλήσατε." : "Celebrate the fact that you got unstuck."
      },
      S: { // Safety Plan
        trigger: isEl ? "Όταν βλέπετε έναν συνάδελφο να παίρνει ρίσκο..." : "When you see a colleague taking a risk...",
        motive: isEl ? "Σκεφτείτε: 'Είμαστε όλοι στο ίδιο σύστημα'." : "Think: 'We are all in the same system'.",
        action: isEl ? "Πλησιάστε και κάντε μια ερώτηση περιέργειας, όχι κριτικής." : "Approach and ask a question out of curiosity, not judgment.",
        reward: isEl ? "Νιώστε τη σύνδεση της ομάδας." : "Feel the team connection."
      }
    };
    const p = plans[minDim];
    const labels = TEXT[lang];
    return `
      <div class="plan-step"><span class="plan-label">${labels.s1}</span><div class="plan-content">${p.trigger}</div></div>
      <div class="plan-step"><span class="plan-label">${labels.s2}</span><div class="plan-content">${p.motive}</div></div>
      <div class="plan-step"><span class="plan-label">${labels.s3}</span><div class="plan-content">${p.action}</div></div>
      <div class="plan-step"><span class="plan-label">${labels.s4}</span><div class="plan-content">${p.reward}</div></div>
    `;
  }

  /* --- APP STATE --- */
  let curLang = "el";
  const answers = JSON.parse(localStorage.getItem("isrra_pro_ans") || "{}");

  function init(){
    renderQuiz();
    updateProgress();
    setLang(curLang);
    
    // Event Listeners
    document.getElementById("startBtn").onclick = () => {
      document.getElementById("hero").style.opacity = "0";
      setTimeout(()=>{ 
        document.getElementById("hero").style.display="none"; 
        document.getElementById("app").classList.add("active");
      }, 600);
    };
    
    document.getElementById("heroLang").onclick = toggleLang;
    document.getElementById("appLang").onclick = toggleLang;
    document.getElementById("calcBtn").onclick = calculate;
    document.getElementById("resetBtn").onclick = reset;
    document.getElementById("pdfBtn").onclick = downloadPDF;
    document.getElementById("docBtn").onclick = downloadWord;
  }

  function toggleLang(){ curLang = curLang==="el"?"en":"el"; setLang(curLang); }
  
  function setLang(l){
    const t = TEXT[l];
    document.documentElement.lang = l;
    // Hero
    document.getElementById("hTitle").textContent = t.hT;
    document.getElementById("hText").innerText = t.hTx;
    document.getElementById("startBtn").textContent = t.start;
    document.getElementById("heroLang").textContent = t.hLang;
    // App
    document.getElementById("calcBtn").textContent = t.calc;
    document.getElementById("errorMsg").textContent = t.err;
    renderQuiz(); // Re-render questions for language
  }

  function renderQuiz(){
    const con = document.getElementById("quizContainer");
    con.innerHTML = "";
    
    const dims = [
      {k:"F", l:TEXT[curLang].dimF, d:TEXT[curLang].dimFd},
      {k:"E", l:TEXT[curLang].dimE, d:TEXT[curLang].dimEd},
      {k:"C", l:TEXT[curLang].dimC, d:TEXT[curLang].dimCd},
      {k:"A", l:TEXT[curLang].dimA, d:TEXT[curLang].dimAd},
      {k:"S", l:TEXT[curLang].dimS, d:TEXT[curLang].dimSd},
    ];

    dims.forEach(dim => {
      const block = document.createElement("div");
      block.className = "dim-block";
      block.innerHTML = `
        <div class="dim-header">
          <h2 class="dim-title">${dim.l}</h2>
          <p class="dim-desc">${dim.d}</p>
        </div>
      `;
      
      ITEMS[dim.k].forEach((it, i) => {
        const qid = dim.k + "_" + (i+1);
        const saved = answers[qid];
        const row = document.createElement("div");
        row.className = "item-row";
        
        // Scale generation
        let scales = `<div class="scale-wrap">`;
        for(let v=1; v<=7; v++){
          scales += `
            <label class="scale-opt">
              <input type="radio" name="${qid}" value="${v}" ${saved==v?'checked':''}>
              <span class="scale-box">${v}</span>
            </label>`;
        }
        scales += `</div>`;

        row.innerHTML = `
          <label class="q-text"><span class="req-star">*</span> ${i+1}. ${curLang==='el'?it.gr:it.en}</label>
          ${scales}
          <div class="anchors"><span>${TEXT[curLang].pL}</span><span>${TEXT[curLang].pR}</span></div>
        `;
        
        // Listener
        row.querySelectorAll("input").forEach(inp => {
          inp.addEventListener("change", (e)=>{
            answers[qid] = parseInt(e.target.value);
            localStorage.setItem("isrra_pro_ans", JSON.stringify(answers));
            updateProgress();
          });
        });
        
        block.appendChild(row);
      });
      con.appendChild(block);
    });
  }

  function updateProgress(){
    const cnt = Object.keys(answers).length;
    const pct = Math.round((cnt/50)*100);
    document.getElementById("bar").style.width = pct+"%";
    document.getElementById("progTxt").textContent = `${cnt}/50`;
  }

  function reset(){
    if(confirm("Reset assessment?")){
      localStorage.removeItem("isrra_pro_ans");
      location.reload();
    }
  }

  function calculate(){
    const cnt = Object.keys(answers).length;
    if(cnt < 50){
      document.getElementById("errorMsg").style.display = "block";
      return;
    }
    document.getElementById("errorMsg").style.display = "none";
    
    // Scoring
    const scores = {};
    const states = {};
    let lowestScore = 8;
    let lowestDim = "F";

    ["F","E","C","A","S"].forEach(k => {
      let sum = 0;
      for(let i=1; i<=10; i++){
        let v = answers[k+"_"+i];
        if(REVERSE[k].includes(i)) v = 8 - v;
        sum += v;
      }
      const avg = sum/10;
      scores[k] = avg;
      states[k] = avg >= 4.0 ? "H" : "L";
      
      if(avg < lowestScore){
        lowestScore = avg;
        lowestDim = k;
      }
    });

    // Populate Report
    document.getElementById("rDate").textContent = new Date().toLocaleDateString();
    document.getElementById("rEmail").textContent = document.getElementById("uEmail").value || "N/A";
    
    // Code
    const code = ["F","E","C","A","S"].map(k => states[k]==="H"?k:k.toLowerCase()).join("");
    document.getElementById("rCode").textContent = code;
    
    // Name
    const n1 = states.S==="H" ? (curLang==='el'?"Ομαδικός":"Team Oriented") : (curLang==='el'?"Ατομικός":"Independent");
    const n2 = states.F==="H" ? (curLang==='el'?"Στρατηγικός":"Strategic") : (curLang==='el'?"Αμυντικός":"Defensive");
    document.getElementById("rName").textContent = `${n1} & ${n2}`;

    // Rich Desc
    let descHTML = "";
    ["F","E","C","A","S"].forEach(k => {
       descHTML += `<p><strong>${TEXT[curLang]['dim'+k]}:</strong> ${INTERP[k][states[k]][curLang]}</p>`;
    });
    document.getElementById("rDesc").innerHTML = descHTML;

    // Table
    const tbody = document.getElementById("rTable");
    tbody.innerHTML = "";
    ["F","E","C","A","S"].forEach(k => {
      const st = states[k];
      tbody.innerHTML += `
        <tr>
          <td>${TEXT[curLang]['dim'+k]}</td>
          <td><b>${scores[k].toFixed(1)}</b></td>
          <td><span class="badge ${st}">${st==='H'?'HIGH':'LOW'}</span></td>
        </tr>`;
    });

    // Atomic Plan
    document.getElementById("rPlan").innerHTML = getPlan(lowestDim, curLang);

    // Show Results
    document.getElementById("results").classList.add("visible");
    setTimeout(() => {
       document.getElementById("results").scrollIntoView({ behavior: 'smooth' });
    }, 200);
  }

  function downloadPDF(){
    const el = document.getElementById("reportContainer");
    const opt = {
      margin: 10,
      filename: 'ISRRA_Professional_Report.pdf',
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2, useCORS:true },
      jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };
    html2pdf().set(opt).from(el).save();
  }

  function downloadWord(){
    const content = document.getElementById("reportContainer").innerHTML;
    const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word'><head><meta charset='utf-8'></head><body>";
    const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(header + content + "</body></html>");
    const link = document.createElement("a");
    link.href = source;
    link.download = 'ISRRA_Report.doc';
    link.click();
  }

  init();
</script>
</body>
</html>
