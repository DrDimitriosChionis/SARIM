<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ISRRA-Q | Dr Dimitrios Chionis</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Noto+Sans:wght@400;500;700&display=swap" rel="stylesheet">
  
  <style>
    :root{
      --bg: #0f172a;
      --panel: #1e293b;
      --text: #f8fafc;
      --muted: #94a3b8;
      --accent: #0ea5e9;
      --radius: 8px;
    }

    *{ box-sizing: border-box; }
    html,body{ height: 100%; }
    body{
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      line-height: 1.5;
    }

    /* --- HERO --- */
    .hero-screen {
      position: fixed; inset: 0; z-index: 9999;
      background: radial-gradient(circle at 50% 30%, #1e293b 0%, #0f172a 90%);
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 20px; text-align: center; transition: opacity 0.5s ease;
    }
    .hero-content { max-width: 700px; animation: fadeInUp 0.8s ease-out; }
    .hero-title {
      font-size: 2.5rem; font-weight: 800; margin-bottom: 20px; letter-spacing: -1px;
      background: linear-gradient(135deg, #fff, #94a3b8);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .hero-text { font-size: 1.1rem; color: var(--muted); margin-bottom: 40px; font-weight: 300; }
    .hero-btn {
      background: var(--text); color: var(--bg); border: none; padding: 16px 40px;
      font-size: 1rem; font-weight: 700; border-radius: 50px; cursor: pointer;
      transition: transform 0.2s;
    }
    .hero-btn:hover { transform: scale(1.05); }
    .lang-toggle-abs { position: absolute; top: 20px; right: 20px; background: transparent; border: 1px solid rgba(255,255,255,0.2); color: white; padding: 6px 14px; border-radius: 20px; cursor: pointer; font-size: 0.8rem; }
    
    @keyframes fadeInUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }

    /* --- APP --- */
    .app-container {
      max-width: 900px; margin: 0 auto; padding: 40px 20px 100px;
      display: none; opacity: 0; transition: opacity 1s ease;
    }
    .app-container.visible { display: block; opacity: 1; }

    header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px;
    }
    .brand h1 { font-size: 1.2rem; margin: 0; color: var(--accent); }
    .nav-btns button {
      background: transparent; border: 1px solid rgba(255,255,255,0.15); color: var(--muted);
      padding: 5px 10px; border-radius: 6px; cursor: pointer; font-size: 0.8rem; margin-left: 8px;
    }

    /* --- QUESTIONS --- */
    .dim-section { margin-bottom: 40px; }
    .dim-head h2 { margin: 0; font-size: 1.2rem; color: var(--text); border-left: 3px solid var(--accent); padding-left: 10px; }
    .dim-head p { margin: 4px 0 0 13px; font-size: 0.85rem; color: var(--muted); }

    .q-item { margin-bottom: 20px; background: var(--panel); padding: 15px; border-radius: var(--radius); }
    .q-text { display: block; font-size: 0.95rem; margin-bottom: 10px; font-weight: 500; }
    .req { color: #f59e0b; margin-right: 4px; }

    .scale-row { display: flex; gap: 4px; }
    .scale-opt { flex: 1; position: relative; text-align: center; cursor: pointer; }
    .scale-opt input { position: absolute; opacity: 0; cursor: pointer; }
    .scale-label {
      display: block; padding: 8px 0; background: rgba(0,0,0,0.2); border-radius: 4px;
      font-size: 0.85rem; color: var(--muted); transition: 0.2s;
    }
    .scale-opt input:checked + .scale-label { background: var(--accent); color: #000; font-weight: 700; }
    .anchors { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--muted); margin-top: 5px; }

    .submit-wrap { text-align: center; margin-top: 40px; }
    .calc-btn {
      background: var(--accent); color: #0f172a; border: none; padding: 14px 40px;
      font-size: 1rem; font-weight: 700; border-radius: 8px; cursor: pointer;
    }
    .error-msg { color: #fb7185; margin-top: 10px; display: none; font-size: 0.9rem; }

    /* --- COMPACT REPORT (One Page) --- */
    .results-area { display: none; margin-top: 40px; }
    .results-area.active { display: block; }

    /* This class styles the content specifically to look good in Word / Print */
    .paper-doc {
      background: #ffffff;
      color: #1e293b;
      padding: 30px; /* Reduced padding */
      border-radius: 4px;
      font-family: 'Noto Sans', sans-serif; 
      line-height: 1.3; /* Tighter line height */
    }

    .doc-header {
      border-bottom: 2px solid #0f172a;
      padding-bottom: 10px;
      margin-bottom: 20px;
      display: flex; justify-content: space-between; align-items: flex-end;
    }
    .doc-logo { font-size: 1.4rem; font-weight: 900; color: #0f172a; }
    .doc-rights { font-size: 0.65rem; color: #64748b; font-style: italic; margin-top: 2px; }
    .doc-meta { text-align: right; font-size: 0.75rem; color: #0f172a; }

    .profile-summary {
      background: #f1f5f9;
      border-left: 4px solid #0f172a;
      padding: 15px;
      margin-bottom: 20px;
    }
    .profile-head { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 8px; }
    .profile-code { font-family: monospace; font-size: 1.4rem; font-weight: 700; color: #0ea5e9; }
    .profile-title { font-size: 1.1rem; font-weight: 700; color: #1e293b; text-transform: uppercase; }
    .profile-narrative { font-size: 0.8rem; text-align: justify; color: #334155; } /* Small text */

    /* Compact Table */
    .score-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 0.8rem; }
    .score-table th { text-align: left; padding: 4px; border-bottom: 1px solid #cbd5e1; color: #64748b; }
    .score-table td { padding: 4px; border-bottom: 1px solid #e2e8f0; color: #0f172a; }
    .status-tag { font-size: 0.7rem; font-weight: 700; padding: 1px 4px; border-radius: 3px; }
    .st-h { background: #dcfce7; color: #166534; }
    .st-l { background: #fee2e2; color: #991b1b; }

    /* Compact Plan */
    .plan-section { border: 1px solid #e2e8f0; border-radius: 6px; padding: 15px; }
    .plan-head { font-size: 0.9rem; font-weight: 800; color: #0f172a; margin: 0 0 10px 0; text-transform: uppercase; border-bottom: 1px solid #e2e8f0; padding-bottom: 5px; }
    
    .plan-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; } /* 2 Columns for compactness */
    .plan-step { margin-bottom: 0; border-left: 2px solid #cbd5e1; padding-left: 8px; }
    .plan-lbl { font-size: 0.65rem; text-transform: uppercase; color: #64748b; font-weight: 700; display: block; }
    .plan-txt { font-size: 0.8rem; color: #0f172a; font-weight: 600; margin: 2px 0 0; }

    .input-section { margin-bottom: 15px; background: var(--panel); padding: 10px; border-radius: var(--radius); }
    .email-inp { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #475569; background: #0f172a; color: white; }
    .dl-doc { width: 100%; padding: 15px; border: none; border-radius: 6px; cursor: pointer; font-weight: 700; font-size: 1rem; background: #e2e8f0; color: #0f172a; }
    .dl-doc:hover { background: #cbd5e1; }

  </style>
</head>

<body>

  <div class="hero-screen" id="hero">
    <button class="lang-toggle-abs" id="heroLang">English</button>
    <div class="hero-content">
      <h1 class="hero-title" id="hTitle">Το Ρίσκο είναι Αφήγηση</h1>
      <p class="hero-text" id="hText">
        Κάθε μέρα παίρνεις αποφάσεις υπό πίεση. Το ISRRA δεν σε βαθμολογεί. Χαρτογραφεί τον "κώδικά" σου.
        Ανακάλυψε το προφίλ σου και λάβετε ένα επαγγελματικό πλάνο δράσης.
      </p>
      <button class="hero-btn" id="startBtn">START ASSESSMENT</button>
    </div>
  </div>

  <div class="app-container" id="app">
    <header>
      <div class="brand">
        <h1>ISRRA-Q</h1>
        <small>Dr Dimitrios Chionis</small>
      </div>
      <div class="nav-btns">
        <span id="progTxt" style="color:#64748b; font-size:0.8rem;">0/50</span>
        <button id="appLang">EN/GR</button>
        <button id="resetBtn">Reset</button>
      </div>
    </header>

    <div id="questionsWrap"></div>

    <div class="submit-wrap">
      <button class="calc-btn" id="calcBtn">Υπολογισμός</button>
      <p class="error-msg" id="errorMsg">Παρακαλώ απαντήστε σε όλες τις ερωτήσεις.</p>
    </div>

    <div class="results-area" id="results">
      
      <div class="input-section">
        <label style="font-size:0.85rem; color:var(--muted); display:block; margin-bottom:5px;">Email:</label>
        <input type="email" id="uEmail" class="email-inp" placeholder="user@organization.com">
      </div>

      <div class="paper-doc" id="printDoc">
        <div class="doc-header">
          <div>
            <div class="doc-logo">ISRRA-Q REPORT</div>
            <div class="doc-rights">All rights reserved Dr Dimitrios Chionis Military Organisational Psychologist</div>
          </div>
          <div class="doc-meta">
            <div id="rDate">dd/mm/yyyy</div>
            <div id="rEmail" style="font-weight:600;"></div>
          </div>
        </div>

        <div class="profile-summary">
          <div class="profile-head">
            <span class="profile-title" id="rTitle">Profile Name</span>
            <span class="profile-code" id="rCode">-----</span>
          </div>
          <div class="profile-narrative" id="rDesc"></div>
        </div>

        <table class="score-table">
          <thead>
            <tr>
              <th width="40%">Dimension</th>
              <th width="20%">Score</th>
              <th width="40%">Status</th>
            </tr>
          </thead>
          <tbody id="rTable"></tbody>
        </table>

        <div class="plan-section">
          <h3 class="plan-head">Strategic Micro-Plan (14-Day Cycle)</h3>
          <div class="plan-grid" id="rPlan"></div>
        </div>
      </div>
      <div style="margin-top:20px;">
        <button class="dl-doc" id="docBtn">Download Word Report</button>
      </div>
    </div>
  </div>

<script>
  /* --- CONTENT --- */
  const LANG = {
    el: {
      hT: "Το Ρίσκο είναι Αφήγηση",
      hTx: "Το ISRRA χαρτογραφεί τον 'κώδικά' σας στην αβεβαιότητα και παρέχει στρατηγικό πλάνο.",
      start: "ΕΝΑΡΞΗ ΑΞΙΟΛΟΓΗΣΗΣ", hBtn: "English",
      calc: "Υπολογισμός",
      err: "Απαντήστε σε όλες τις ερωτήσεις.",
      dimNames: ["Πλαισίωση (Framing)", "Συναίσθημα (Emotion)", "Επικοινωνία (Comm)", "Δράση (Action)", "Κουλτούρα (Safety)"],
      dimDesc: ["Νοητική κατασκευή.", "Επίδραση στρες.", "Μετάδοση πληροφορίας.", "Ταχύτητα αντίδρασης.", "Συλλογική ευθύνη."],
      anchors: ["Διαφωνώ", "Συμφωνώ"],
      planLabels: ["Trigger", "Reframing", "Micro-Action", "Feedback"]
    },
    en: {
      hT: "Risk is a Narrative",
      hTx: "ISRRA maps your risk 'code' under uncertainty and provides a strategic plan.",
      start: "START ASSESSMENT", hBtn: "Ελληνικά",
      calc: "Calculate",
      err: "Answer all questions.",
      dimNames: ["Framing", "Emotion", "Communication", "Action", "Safety Culture"],
      dimDesc: ["Mental construction.", "Stress impact.", "Info transmission.", "Reaction speed.", "Collective responsibility."],
      anchors: ["Disagree", "Agree"],
      planLabels: ["Trigger", "Reframing", "Micro-Action", "Feedback"]
    }
  };

  /* --- 50 ITEMS (Condensed for code brevity, same logic) --- */
  const ITEMS = {
    F: [
       {en:"I tend to view risk as a challenge rather than a threat.", gr:"Τείνω να βλέπω το ρίσκο ως πρόκληση και όχι ως απειλή."},
       {en:"When faced with uncertainty, I try to make sense of the situation before acting.", gr:"Όταν υπάρχει αβεβαιότητα, προσπαθώ πρώτα να καταλάβω την κατάσταση και μετά να δράσω."},
       {en:"I usually relate risky situations to personal failure.", gr:"Συνήθως συνδέω τις ριψοκίνδυνες καταστάσεις με προσωπική αποτυχία."}, 
       {en:"I can reframe negative events into opportunities for strategic learning.", gr:"Μπορώ να ξαναπλαισιώσω αρνητικά γεγονότα ως ευκαιρίες για στρατηγική μάθηση."},
       {en:"I often get stuck in a single narrative when thinking about risk.", gr:"Συχνά κολλάω σε μία μόνο αφήγηση όταν σκέφτομαι το ρίσκο."}, 
       {en:"The way I talk about risk influences how others perceive it.", gr:"Ο τρόπος που μιλάω για το ρίσκο επηρεάζει το πώς το αντιλαμβάνονται οι άλλοι."},
       {en:"I consciously shape the story I tell myself about danger or uncertainty.", gr:"Συνειδητά διαμορφώνω την ιστορία που λέω στον εαυτό μου για κίνδυνο ή αβεβαιότητα."},
       {en:"I believe that the framing of a problem determines its possible solutions.", gr:"Πιστεύω ότι η πλαισίωση ενός προβλήματος καθορίζει τις πιθανές λύσεις."},
       {en:"I use language that normalises uncertainty when I explain risks to others.", gr:"Χρησιμοποιώ γλώσσα που κανονικοποιεί την αβεβαιότητα όταν εξηγώ ρίσκα σε άλλους."},
       {en:"I experience risk as an open ended experience, not something strictly positive or negative.", gr:"Βιώνω το ρίσκο ως μια ανοιχτή εμπειρία και όχι ως κάτι αυστηρά θετικό ή αρνητικό."},
    ],
    E: [
       {en:"My emotions interfere with how accurately I assess risk.", gr:"Τα συναισθήματά μου παρεμβαίνουν στο πόσο ακριβώς εκτιμώ το ρίσκο."}, 
       {en:"I remain calm and analytical when faced with high pressure situations.", gr:"Παραμένω ήρεμος και αναλυτικός όταν αντιμετωπίζω καταστάσεις υψηλής πίεσης."},
       {en:"I tend to exaggerate potential negative outcomes when under stress.", gr:"Τείνω να υπερβάλλω τις πιθανές αρνητικές εκβάσεις όταν είμαι υπό στρες."}, 
       {en:"I can recognise when fear is distorting my perception of risk.", gr:"Μπορώ να αναγνωρίσω όταν ο φόβος αλλοιώνει την αντίληψή μου για το ρίσκο."},
       {en:"I often assume the worst even when evidence is lacking.", gr:"Συχνά υποθέτω το χειρότερο, ακόμη και όταν λείπουν στοιχεία."}, 
       {en:"I notice how my mood shifts the way I interpret threats.", gr:"Παρατηρώ πώς η διάθεσή μου αλλάζει τον τρόπο που ερμηνεύω απειλές."},
       {en:"I regulate my emotional response before making risk related decisions.", gr:"Ρυθμίζω τη συναισθηματική μου αντίδραση πριν πάρω αποφάσεις σχετικές με ρίσκο."},
       {en:"I struggle to separate personal feelings from objective assessment.", gr:"Δυσκολεύομαι να ξεχωρίσω προσωπικά συναισθήματα από αντικειμενική εκτίμηση."}, 
       {en:"I feel confident in my ability to assess risk clearly under pressure.", gr:"Νιώθω σίγουρος ότι μπορώ να εκτιμώ καθαρά το ρίσκο υπό πίεση."},
       {en:"I use mental strategies to avoid overreacting in uncertain situations.", gr:"Χρησιμοποιώ νοητικές στρατηγικές για να αποφεύγω την υπεραντίδραση σε καταστάσεις αβεβαιότητας."},
    ],
    C: [
       {en:"I know how to communicate risk without causing panic.", gr:"Ξέρω πώς να επικοινωνώ το ρίσκο χωρίς να προκαλώ πανικό."},
       {en:"I adapt my message depending on who I’m speaking to in risky situations.", gr:"Προσαρμόζω το μήνυμά μου ανάλογα με το σε ποιον μιλάω σε ριψοκίνδυνες καταστάσεις."},
       {en:"I prefer to avoid discussing risks if they are emotionally charged.", gr:"Προτιμώ να αποφεύγω τη συζήτηση για ρίσκα όταν έχουν έντονο συναισθηματικό φορτίο."}, 
       {en:"I can clearly explain what makes a situation risky.", gr:"Μπορώ να εξηγήσω καθαρά τι κάνει μια κατάσταση ριψοκίνδυνη."},
       {en:"I often hesitate to express concern about potential dangers.", gr:"Συχνά διστάζω να εκφράσω ανησυχία για πιθανούς κινδύνους."}, 
       {en:"I structure risk related information to help others act appropriately.", gr:"Δομώ τις πληροφορίες για το ρίσκο ώστε να βοηθώ τους άλλους να δράσουν κατάλληλα."},
       {en:"I use storytelling when communicating risk to others.", gr:"Χρησιμοποιώ αφήγηση όταν επικοινωνώ ρίσκο σε άλλους."},
       {en:"I am confident in my ability to express complex threats in simple terms.", gr:"Νιώθω σίγουρος ότι μπορώ να εξηγώ σύνθετες απειλές με απλούς όρους."},
       {en:"I avoid downplaying or exaggerating risk when talking to others.", gr:"Αποφεύγω να υποβαθμίζω ή να υπερβάλλω το ρίσκο όταν μιλάω σε άλλους."},
       {en:"I communicate risks in a way that encourages responsible action.", gr:"Επικοινωνώ τα ρίσκα με τρόπο που ενθαρρύνει υπεύθυνη δράση."},
    ],
    A: [
       {en:"When I sense risk, I take action quickly and deliberately.", gr:"Όταν αντιλαμβάνομαι ρίσκο, δρω γρήγορα και σκόπιμα."},
       {en:"I often know what to do, but delay action due to uncertainty.", gr:"Συχνά ξέρω τι πρέπει να κάνω, αλλά καθυστερώ λόγω αβεβαιότητας."}, 
       {en:"I act in alignment with what I understand about the situation's risk.", gr:"Δρω σε ευθυγράμμιση με αυτά που καταλαβαίνω για το ρίσκο της κατάστασης."},
       {en:"I adapt my behaviour based on my assessment of threats.", gr:"Προσαρμόζω τη συμπεριφορά μου με βάση την εκτίμησή μου για τις απειλές."},
       {en:"I feel paralysed when I encounter situations involving uncertainty.", gr:"Νιώθω παράλυση όταν αντιμετωπίζω καταστάσεις με αβεβαιότητα."}, 
       {en:"I follow through with planned actions even under pressure.", gr:"Ολοκληρώνω τις προγραμματισμένες ενέργειες ακόμη και υπό πίεση."},
       {en:"I take steps to mitigate risk rather than ignore it.", gr:"Κάνω βήματα για να μετριάσω το ρίσκο, αντί να το αγνοώ."},
       {en:"I find it easy to operationalise my thoughts into concrete behaviours.", gr:"Μου είναι εύκολο να μετατρέπω τις σκέψεις μου σε συγκεκριμένες συμπεριφορές."},
       {en:"I respond to emerging threats in a methodical and structured way.", gr:"Απαντώ σε αναδυόμενες απειλές με μεθοδικό και δομημένο τρόπο."},
       {en:"I often fail to implement what I know should be done in risky situations.", gr:"Συχνά αποτυγχάνω να εφαρμόσω αυτό που ξέρω ότι πρέπει να γίνει σε ριψοκίνδυνες καταστάσεις."}, 
    ],
    S: [
       {en:"I feel responsible for contributing to the safety of my team.", gr:"Νιώθω υπεύθυνος να συμβάλλω στην ασφάλεια της ομάδας μου."},
       {en:"I often stay silent about safety concerns to avoid conflict.", gr:"Συχνά μένω σιωπηλός για θέματα ασφάλειας, για να αποφύγω σύγκρουση."}, 
       {en:"I believe my input on safety matters is valued in my environment.", gr:"Πιστεύω ότι η γνώμη μου για θέματα ασφάλειας εκτιμάται στο περιβάλλον μου."},
       {en:"I act in ways that support a shared culture of responsibility.", gr:"Λειτουργώ με τρόπους που στηρίζουν μια κοινή κουλτούρα ευθύνης."},
       {en:"I feel disconnected from how safety is managed around me.", gr:"Νιώθω αποσυνδεδεμένος από το πώς διαχειρίζεται η ασφάλεια γύρω μου."}, 
       {en:"I encourage others to speak up when they notice risk.", gr:"Ενθαρρύνω τους άλλους να μιλήσουν όταν παρατηρούν ρίσκο."},
       {en:"I see myself as part of the broader safety system, not just an individual.", gr:"Βλέπω τον εαυτό μου ως μέρος του ευρύτερου συστήματος ασφάλειας και όχι μόνο ως άτομο."},
       {en:"I take initiative to improve how my group handles risky situations.", gr:"Παίρνω πρωτοβουλία για να βελτιώσω το πώς η ομάδα μου χειρίζεται ριψοκίνδυνες καταστάσεις."},
       {en:"I trust that if I report a problem, it will be taken seriously.", gr:"Εμπιστεύομαι ότι αν αναφέρω ένα πρόβλημα, θα ληφθεί σοβαρά υπόψη."},
       {en:"I feel that my values align with the safety culture of my workplace team.", gr:"Νιώθω ότι οι αξίες μου ευθυγραμμίζονται με την κουλτούρα ασφάλειας του χώρου ή της ομάδας μου."},
    ]
  };

  const REVERSE = { F:[3,5], E:[1,3,5,8], C:[3,5], A:[2,5,10], S:[2,5] };
  
  // THEORY STRINGS
  const THEORY = {
    F: {
      H: { el:"Growth Mindset (Prospect Theory): Βλέπετε πιθανά κέρδη στην αβεβαιότητα, όχι μόνο απώλειες.", en:"Growth Mindset (Prospect Theory): You focus on potential gains in uncertainty, not just losses." },
      L: { el:"Loss Aversion: Η αβεβαιότητα ερμηνεύεται ως απειλή, οδηγώντας σε ακαμψία.", en:"Loss Aversion: Uncertainty is interpreted as a threat, leading to rigidity." }
    },
    E: {
      H: { el:"Emotional Regulation: Διαχωρίζετε τα δεδομένα από το φόβο (Affect Heuristic).", en:"Emotional Regulation: You separate data from fear (Affect Heuristic)." },
      L: { el:"Cognitive Tunneling: Το στρες μειώνει την περιφερειακή αντίληψη και την κρίση.", en:"Cognitive Tunneling: Stress reduces peripheral perception and judgement." }
    },
    C: {
      H: { el:"Transparency: Μειώνετε την εντροπία της πληροφορίας στο σύστημα.", en:"Transparency: You reduce information entropy within the system." },
      L: { el:"Information Silos: Ο φόβος κρίσης εμποδίζει τη ροή κρίσιμων σημάτων.", en:"Information Silos: Fear of judgment blocks critical signal flow." }
    },
    A: {
      H: { el:"Action Bias: Προτιμάτε τη γρήγορη, ατελή δράση από την τέλεια αδράνεια.", en:"Action Bias: You prefer swift, imperfect action over perfect inaction." },
      L: { el:"Analysis Paralysis: Η ανάγκη για βεβαιότητα αυξάνει το κόστος ευκαιρίας.", en:"Analysis Paralysis: The need for certainty increases opportunity cost." }
    },
    S: {
      H: { el:"Safety-II: Η ασφάλεια είναι η παρουσία προσαρμοστικότητας, όχι η απουσία λαθών.", en:"Safety-II: Safety is the presence of adaptability, not the absence of errors." },
      L: { el:"Learned Helplessness: Αντιμετωπίζετε την ασφάλεια παθητικά, ως συμμόρφωση.", en:"Learned Helplessness: You treat safety passively, as compliance." }
    }
  };

  const PLANS = {
    F: {
      el: ["Νέο, ασαφές δεδομένο.", "Ερώτηση: 'Τι κερδίζουμε αν προσαρμοστούμε;'", "Γράψτε 3 σενάρια σε 5 λεπτά.", "Επιβεβαιώστε μείωση αβεβαιότητας."],
      en: ["New, ambiguous data.", "Ask: 'What do we gain if we adapt?'", "Write 3 scenarios in 5 mins.", "Verify reduced uncertainty."]
    },
    E: {
      el: ["Σωματική ένταση/ταχυπαλμία.", "Αναγνώριση: 'Είναι βιολογικό στρες'.", "Παύση 60 δευτερολέπτων.", "Παρατήρηση καθαρής κρίσης."],
      en: ["Physical tension.", "Recognize: 'It is biological stress'.", "60-second pause.", "Observe clear judgement."]
    },
    C: {
      el: ["Δισταγμός αναφοράς λάθους.", "Σκέψη: 'Η σιωπή είναι κίνδυνος'.", "Ερώτηση ανοιχτού τύπου.", "Επιβεβαίωση λήψης μηνύματος."],
      en: ["Hesitation to report error.", "Think: 'Silence is a risk'.", "Open-ended question.", "Confirm message receipt."]
    },
    A: {
      el: ["Υπερ-ανάλυση χωρίς δράση.", "Αρχή: Η δράση φέρνει δεδομένα.", "Μικρή κίνηση εντός 1 ώρας.", "Καταγραφή αποτελέσματος."],
      en: ["Over-analysis.", "Principle: Action yields data.", "Small move within 1 hour.", "Record outcome."]
    },
    S: {
      el: ["Παραβίαση διαδικασίας.", "Σκέψη: 'Είμαι θεματοφύλακας'.", "Παρέμβαση με περιέργεια.", "Αναγνώριση συμβολής."],
      en: ["Procedure violation.", "Think: 'I am a guardian'.", "Curious intervention.", "Acknowledge contribution."]
    }
  };

  /* --- APP LOGIC --- */
  let curLang = "el";
  const answers = JSON.parse(localStorage.getItem("isrra_v5") || "{}");

  function init(){
    renderApp();
    document.getElementById("startBtn").onclick = () => {
      document.getElementById("hero").style.display="none"; 
      document.getElementById("app").classList.add("visible");
    };
    document.getElementById("heroLang").onclick = toggleLang;
    document.getElementById("appLang").onclick = toggleLang;
    document.getElementById("calcBtn").onclick = calculate;
    document.getElementById("resetBtn").onclick = () => {
      if(confirm("Reset?")) { localStorage.removeItem("isrra_v5"); location.reload(); }
    };
    document.getElementById("docBtn").onclick = downloadDoc;
  }

  function toggleLang(){ curLang = curLang==="el"?"en":"el"; renderApp(); }

  function renderApp(){
    document.documentElement.lang = curLang;
    const t = LANG[curLang];
    document.getElementById("hTitle").textContent = t.hT;
    document.getElementById("hText").innerText = t.hTx;
    document.getElementById("startBtn").textContent = t.start;
    document.getElementById("calcBtn").textContent = t.calc;
    document.getElementById("errorMsg").textContent = t.err;
    updateProgress();

    const con = document.getElementById("questionsWrap");
    con.innerHTML = "";
    ["F","E","C","A","S"].forEach((k, i) => {
      const sec = document.createElement("div");
      sec.className = "dim-section";
      sec.innerHTML = `<div class="dim-head"><h2>${t.dimNames[i]}</h2><p>${t.dimDesc[i]}</p></div>`;
      
      ITEMS[k].forEach((it, idx) => {
        const qid = k + "_" + (idx+1);
        const div = document.createElement("div");
        div.className = "q-item";
        let opts = "";
        for(let v=1; v<=7; v++){
          opts += `<label class="scale-opt"><input type="radio" name="${qid}" value="${v}" ${answers[qid]==v?'checked':''}><span class="scale-label">${v}</span></label>`;
        }
        div.innerHTML = `<label class="q-text"><span class="req">*</span>${idx+1}. ${curLang==='el'?it.gr:it.en}</label><div class="scale-row">${opts}</div><div class="anchors"><span>${t.anchors[0]}</span><span>${t.anchors[1]}</span></div>`;
        div.querySelectorAll("input").forEach(inp => inp.onchange = (e) => {
          answers[qid] = parseInt(e.target.value);
          localStorage.setItem("isrra_v5", JSON.stringify(answers));
          updateProgress();
        });
        sec.appendChild(div);
      });
      con.appendChild(sec);
    });
  }

  function updateProgress(){ document.getElementById("progTxt").textContent = Object.keys(answers).length + "/50"; }

  function calculate(){
    if(Object.keys(answers).length < 50){ document.getElementById("errorMsg").style.display="block"; return; }
    document.getElementById("errorMsg").style.display="none";

    const scores = {}, states = {};
    let minS = 8, minD = "F";

    ["F","E","C","A","S"].forEach(k => {
      let sum = 0;
      for(let i=1; i<=10; i++){
        let v = answers[k+"_"+i];
        if(REVERSE[k].includes(i)) v = 8 - v;
        sum += v;
      }
      const avg = sum/10;
      scores[k] = avg;
      states[k] = avg >= 4.0 ? "H" : "L";
      if(avg < minS){ minS = avg; minD = k; }
    });

    // Populate Report
    const d = new Date();
    document.getElementById("rDate").textContent = `${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}`;
    document.getElementById("rEmail").textContent = document.getElementById("uEmail").value;
    
    document.getElementById("rCode").textContent = ["F","E","C","A","S"].map(k=>states[k]==='H'?k:k.toLowerCase()).join("");
    const tS = states.S==='H'?(curLang==='el'?'Ομαδικός':'Team'):(curLang==='el'?'Ατομικός':'Solo');
    const tF = states.F==='H'?(curLang==='el'?'Στρατηγικός':'Strategic'):(curLang==='el'?'Αμυντικός':'Defensive');
    document.getElementById("rTitle").textContent = `${tS} & ${tF}`;

    let desc = "";
    ["F","E","C","A","S"].forEach(k => {
      desc += `<p><strong>${LANG[curLang].dimNames[["F","E","C","A","S"].indexOf(k)]}:</strong> ${THEORY[k][states[k]][curLang]}</p>`;
    });
    document.getElementById("rDesc").innerHTML = desc;

    let tbl = "";
    ["F","E","C","A","S"].forEach((k,i) => {
      tbl += `<tr><td>${LANG[curLang].dimNames[i]}</td><td>${scores[k].toFixed(1)}</td><td><span class="status-tag ${states[k]==='H'?'st-h':'st-l'}">${states[k]==='H'?'HIGH':'LOW'}</span></td></tr>`;
    });
    document.getElementById("rTable").innerHTML = tbl;

    const p = PLANS[minD][curLang];
    const lbl = LANG[curLang].planLabels;
    let pln = "";
    p.forEach((step, i) => {
      pln += `<div class="plan-step"><span class="plan-lbl">${lbl[i]}</span><p class="plan-txt">${step}</p></div>`;
    });
    document.getElementById("rPlan").innerHTML = pln;

    document.getElementById("results").classList.add("active");
    setTimeout(()=>document.getElementById("results").scrollIntoView({behavior:'smooth'}), 200);
  }

  function downloadDoc(){
    const content = document.getElementById("printDoc").innerHTML;
    const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word'><head><meta charset='utf-8'></head><body>";
    const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(header + content + "</body></html>");
    const link = document.createElement("a");
    link.href = source;
    link.download = 'ISRRA_Report.doc';
    link.click();
  }

  init();
</script>
</body>
</html>
